#利用Json-Schema反向验证后台服务返回的数据格式

本文最新整理版,请点击如下地址访问：[https://gold.xitu.io/post/58b9217c8ac2470d784ff5de](https://gold.xitu.io/post/58b9217c8ac2470d784ff5de)

##缘起
有时候前端已经做完界面交互，数据显示的时候，后台还没有完成相关数据的查询，合并，处理，返回，导致经常确定好的接口中的某个字段，某个数据为空，或格式不正确，从而使前端页面显示错乱。在团队开发中，为了规避这样的问题，我考虑通过设计接口返回数据格式验证机制，实现对后台接口返回数据的格式验证，在前端获取数据回调时第一时间检查，防止错误数据返回到界面，导致显示错乱。
##设计思路
1.	前端通过ajax请求接口数据；
2.	接口返回数据后，先根据该接口名找到对应的json-schema文件；
3.	调用json-schema验证库验证方法，如果验证失败，则返回异常提示。验证通过，则数据继续返回到前端上层。
4.	各接口配置文件在单页加载前提前加载。
5.	可以设置总开关，配置是否打开数据验证；
6.	可以针对单个接口设置开关。总开关优先；

##参考
[http://json-schema.org/latest/json-schema-validation.html](http://json-schema.org/latest/json-schema-validation.html)



